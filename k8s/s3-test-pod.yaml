# apiVersion: v1
# kind: Pod
# metadata:
#   name: s3-test
#   namespace: flink-stage
# spec:
#   serviceAccountName: flink
#   containers:
#     - name: s3-test
#       image: amazonlinux
#       command: ["/bin/sh", "-c", "yum install -y aws-cli && aws s3 ls s3://eks-flink-bucket"]
#   restartPolicy: Never

apiVersion: v1
kind: Pod
metadata:
  name: s3-test-create-dir
  namespace: flink-stage
spec:
  serviceAccountName: flink
  containers:
    - name: s3-test
      image: amazonlinux
      command: ["/bin/sh", "-c"]
      args:
        - |
          yum install -y aws-cli && \
          aws s3api put-object --bucket eks-flink-bucket --key test/ && \
          echo "Created 'test/' in eks-flink-bucket" && \
          aws s3 ls s3://eks-flink-bucket/
  restartPolicy: Never
